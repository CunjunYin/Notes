## Validation process before issue Authorization Code 

When OAuth server received request from Third Party. Some common validations are required before respond credential page to the user.
```c#
// Check the request is for Authorization Code 
if(!string.Equals("code", model.responseType))
{
    // Invalid Request
}

// Client registration: The Client must be registered with the authorization server,the request must include client ID and secret key. This step helps ensure the client is legitimate.
var client = clients.getClientOrNull(model.client_id)
if (client == null)
{
    // Unknow Client, reject   
}

// Redirect URI validation: the request need to contain one redirect URI where the authorization code will be sent. To prevent unauthorized access, OAuth Server need to check it's registered.
if (!client.redirectUris.Contain(model.redirectUri))
{
    // Wrong redirectUri, reject 
}

// Scope verification: client request scopes to access resources, but those scopes must be pre-registered.
for (scope in model.scopes)
{
    if(!client.scopes.Contain(scope))
    {
        // Out of registered scopes, reject 
    }
}

// return credential page to user
```

OAuth server initiates an authentication and authorization request and gather user credential and approved scopes, again to ensure user authorized scopes are align with client `requsted scopes`.

```c#
if (!checkScope(model.scopes, loginModel.scopes))
{
    // Requested scopes are out of user approved scopes
}
```

3. After successfull authentication, the OAuth server respond a redirect request with Authorization Code

```c#
string code = generateAuthorizationCode(client);

return Redirect(string.format("{0}?code={1}", model.redirect_uri, code))
```

